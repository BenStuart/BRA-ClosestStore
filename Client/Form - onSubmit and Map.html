<form>
    <input type="text" id="address-input" value ="default">
    <br>
    <input type="button" value="Submit" onclick="searchAddress();">
</form>

<div id="map-canvas" style="height: 400px; width: 100%; "> </div>

<script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<script>
function triggerMap(){

}

//Listener to trigger initialize function on window load
google.maps.event.addDomListener(window, "load", initialize);

var map;
var marker;
// Initialize map configurations
function initialize() {
    console.log("initialized");
    var MapOptions = {
        center: new google.maps.LatLng(-27.3752881, 133.775136),
		zoom: 4,
		mapTypeid: google.maps.MapTypeId.ROADMAP,
	};
	map = new google.maps.Map(document.getElementById("map-canvas"), MapOptions);
}

//Get the long&lat of address, creates marker, centers on marker, zooms in
function searchAddress() {
  var addressInput = document.getElementById('address-input').value;
  
  console.log("Address is:" + addressInput);
  
  var geocoder = new google.maps.Geocoder();
      geocoder.geocode({address: addressInput, componentRestrictions: {country: 'AU'}}, function(results, status) {
    
        if (status == google.maps.GeocoderStatus.OK) {

          var myResult = results[0].geometry.location; // reference LatLng value
          
          var latToBePassed = results[0].geometry.location.lat();
          var longToBePassed = results[0].geometry.location.lng();
          
          //console.log(myResult); //display long and lat
          //console.log(results[0].geometry.location.lat()); //display lat
          
          createMarker(myResult); //call the function that adds the marker

          map.setCenter(myResult);
          map.setZoom(17);

          //Post long and Lat data to NodeJS server - get response back with closest store
          $.ajax({ 
            type: "POST", 
            url: "http://localhost:3000/geocode", 
            data: {latitude: latToBePassed, longitude: longToBePassed},
            success: function(data) {
              alert(data)
            },
            error: function(err) {
              console.log('An error occured')
              console.log(err)
            }
          }); 

        }
        else (console.log("Something Broke" + google.maps.GeocoderStatus))
  });
}

//Function called that created the marker object and defines perameters
function createMarker(latlng) {

   // If the user makes another search you must clear the marker variable
   if(marker != undefined && marker != ''){
    marker.setMap(null);
    marker = '';
   }

   marker = new google.maps.Marker({
      map: map,
      position: latlng
   });
}
</script>